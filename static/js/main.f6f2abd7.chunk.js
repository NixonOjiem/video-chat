(this["webpackJsonpvideo-chat"]=this["webpackJsonpvideo-chat"]||[]).push([[0],{18:function(e,t,n){},20:function(e,t,n){},22:function(e,t,n){"use strict";n.r(t);var a,c,o,i=n(3),r=n.n(i),s=n(13),l=n.n(s),d=(n(18),n(9));n(23);function h(){return(h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(null,arguments)}function j(e,t){let{title:n,titleId:r,...s}=e;return i.createElement("svg",h({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-phone-missed",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,a||(a=i.createElement("line",{x1:23,y1:1,x2:17,y2:7})),c||(c=i.createElement("line",{x1:17,y1:1,x2:23,y2:7})),o||(o=i.createElement("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})))}const u=i.forwardRef(j);var b,p,f;n.p;function m(){return(m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(null,arguments)}function w(e,t){let{title:n,titleId:a,...c}=e;return i.createElement("svg",m({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-more-vertical",ref:t,"aria-labelledby":a},c),n?i.createElement("title",{id:a},n):null,b||(b=i.createElement("circle",{cx:12,cy:12,r:1})),p||(p=i.createElement("circle",{cx:12,cy:5,r:1})),f||(f=i.createElement("circle",{cx:12,cy:19,r:1})))}const v=i.forwardRef(w);var g,x;n.p;function O(){return(O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(null,arguments)}function y(e,t){let{title:n,titleId:a,...c}=e;return i.createElement("svg",O({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-copy",ref:t,"aria-labelledby":a},c),n?i.createElement("title",{id:a},n):null,g||(g=i.createElement("rect",{x:9,y:9,width:13,height:13,rx:2,ry:2})),x||(x=i.createElement("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})))}const C=i.forwardRef(y);n.p,n(20);var k=n(2);var N=function(){return Object(k.jsxs)("div",{className:"Navigation-bar",children:[Object(k.jsx)("h3",{className:"App-name",children:"Video chat"}),Object(k.jsxs)("ul",{className:"List-items",children:[Object(k.jsx)("li",{children:Object(k.jsx)("a",{href:"https://github.com/NixonOjiem/video-chat",children:"Github"})}),Object(k.jsx)("li",{children:Object(k.jsx)("a",{href:"https://myportfolio-cde82.web.app/",children:"Portfolio"})})]})]})};const E={apiKey:"AIzaSyAFwxz_LlUYMA4g3q0ucXBWIv6Hhqr7yXw",authDomain:"simple-currency-converte-6e98d.firebaseapp.com",projectId:"simple-currency-converte-6e98d",storageBucket:"simple-currency-converte-6e98d.appspot.com",messagingSenderId:"603085476950",appId:"1:603085476950:web:8b767faf5e24b89a1797f7",measurementId:"G-VXK02NG2J7"};d.a.apps.length||d.a.initializeApp(E);const I=d.a.firestore(),S=new RTCPeerConnection({iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10});function P(e){let{joinCode:t,setJoinCode:n,setPage:a}=e;return Object(k.jsxs)("div",{className:"home",children:[Object(k.jsx)("div",{className:"create box",children:Object(k.jsx)("button",{onClick:()=>a("create"),children:"Create Call"})}),Object(k.jsxs)("div",{className:"answer box",children:[Object(k.jsx)("input",{value:t,onChange:e=>n(e.target.value),placeholder:"Join with code"}),Object(k.jsx)("button",{onClick:()=>a("join"),children:"Answer"})]})]})}function L(e){let{mode:t,callId:n,setPage:a}=e;const[c,o]=Object(i.useState)(!1),[r,s]=Object(i.useState)(n),l=Object(i.useRef)(),d=Object(i.useRef)(),h=async()=>{if(S.close(),r){let e=I.collection("calls").doc(r);await e.collection("answerCandidates").get().then((e=>{e.forEach((e=>{e.ref.delete()}))})),await e.collection("offerCandidates").get().then((e=>{e.forEach((e=>{e.ref.delete()}))})),await e.delete()}window.location.reload()};return Object(k.jsxs)("div",{className:"videos",children:[Object(k.jsx)("video",{ref:l,autoPlay:!0,playsInline:!0,className:"local",muted:!0}),Object(k.jsx)("video",{ref:d,autoPlay:!0,playsInline:!0,className:"remote"}),Object(k.jsxs)("div",{className:"buttonsContainer",children:[Object(k.jsx)("button",{onClick:h,disabled:!c,className:"hangup button",children:Object(k.jsx)(u,{})}),Object(k.jsxs)("div",{tabIndex:0,role:"button",className:"more button",children:[Object(k.jsx)(v,{}),Object(k.jsx)("div",{className:"popover",children:Object(k.jsxs)("button",{onClick:()=>{navigator.clipboard.writeText(r)},children:[Object(k.jsx)(C,{})," Copy joining code"]})})]})]}),!c&&Object(k.jsx)("div",{className:"modalContainer",children:Object(k.jsxs)("div",{className:"modal",children:[Object(k.jsx)("h3",{children:"Turn on your camera and microphone and start the call"}),Object(k.jsxs)("div",{className:"container",children:[Object(k.jsx)("button",{onClick:()=>a("home"),className:"secondary",children:"Cancel"}),Object(k.jsx)("button",{onClick:async()=>{const e=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),a=new MediaStream;if(e.getTracks().forEach((t=>{S.addTrack(t,e)})),S.ontrack=e=>{e.streams[0].getTracks().forEach((e=>{a.addTrack(e)}))},l.current.srcObject=e,d.current.srcObject=a,o(!0),"create"===t){const e=I.collection("calls").doc(),t=e.collection("offerCandidates"),n=e.collection("answerCandidates");s(e.id),S.onicecandidate=e=>{e.candidate&&t.add(e.candidate.toJSON())};const a=await S.createOffer();await S.setLocalDescription(a);const c={sdp:a.sdp,type:a.type};await e.set({offer:c}),e.onSnapshot((e=>{const t=e.data();if(!S.currentRemoteDescription&&(null===t||void 0===t?void 0:t.answer)){const e=new RTCSessionDescription(t.answer);S.setRemoteDescription(e)}})),n.onSnapshot((e=>{e.docChanges().forEach((e=>{if("added"===e.type){const t=new RTCIceCandidate(e.doc.data());S.addIceCandidate(t)}}))}))}else if("join"===t){const e=I.collection("calls").doc(n),t=e.collection("answerCandidates"),a=e.collection("offerCandidates");S.onicecandidate=e=>{e.candidate&&t.add(e.candidate.toJSON())};const c=(await e.get()).data().offer;await S.setRemoteDescription(new RTCSessionDescription(c));const o=await S.createAnswer();await S.setLocalDescription(o);const i={type:o.type,sdp:o.sdp};await e.update({answer:i}),a.onSnapshot((e=>{e.docChanges().forEach((e=>{if("added"===e.type){let t=e.doc.data();S.addIceCandidate(new RTCIceCandidate(t))}}))}))}S.onconnectionstatechange=e=>{"disconnected"===S.connectionState&&h()}},children:"Start"})]})]})})]})}var R=function(){const[e,t]=Object(i.useState)("home"),[n,a]=Object(i.useState)("");return Object(k.jsxs)("div",{className:"app",children:[Object(k.jsx)(N,{}),"home"===e?Object(k.jsx)(P,{joinCode:n,setJoinCode:a,setPage:t}):Object(k.jsx)(L,{mode:e,callId:n,setPage:t})]})};var T=e=>{e&&e instanceof Function&&n.e(3).then(n.bind(null,24)).then((t=>{let{getCLS:n,getFID:a,getFCP:c,getLCP:o,getTTFB:i}=t;n(e),a(e),c(e),o(e),i(e)}))};l.a.render(Object(k.jsx)(r.a.StrictMode,{children:Object(k.jsx)(R,{})}),document.getElementById("root")),T()}},[[22,1,2]]]);
//# sourceMappingURL=main.f6f2abd7.chunk.js.map